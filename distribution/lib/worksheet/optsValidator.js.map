{"version":3,"sources":["../../../source/lib/worksheet/optsValidator.js"],"names":["types","require","optsTypes","getObjItem","obj","key","returnObj","levels","split","length","thisLevelKey","shift","e","validator","val","type","sizes","Object","keys","paperSize","indexOf","TypeError","join","pageOrder","validate","orientation","positiveUniversalMeasure","cellComment","printError","pane","paneState","parseFloat","parseInt","traverse","o","keyParts","func","i","thisKeyParts","concat","thisKey","thisType","thisItem","module","exports","opts"],"mappings":"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","file":"optsValidator.js","sourcesContent":["const types = require('../types/index.js');\n\nconst optsTypes = {\n    'margins': {\n        'bottom': 'Float',\n        'footer': 'Float',\n        'header': 'Float',\n        'left': 'Float',\n        'right': 'Float',\n        'top': 'Float'\n    },\n    'printOptions': {\n        'centerHorizontal': 'Boolean',\n        'centerVertical': 'Boolean',\n        'printGridLines': 'Boolean',\n        'printHeadings': 'Boolean'\n    \n    },\n    'pageSetup': {\n        'blackAndWhite': 'Boolean',\n        'cellComments': 'CELL_COMMENTS',\n        'copies': 'Integer',\n        'draft': 'Boolean',\n        'errors': 'PRINT_ERROR',\n        'firstPageNumber': 'Boolean',\n        'fitToHeight': 'Integer',\n        'fitToWidth': 'Integer',\n        'horizontalDpi': 'Integer',\n        'orientation': 'ORIENTATION',\n        'pageOrder': 'PAGE_ORDER',\n        'paperHeight': 'POSITIVE_UNIVERSAL_MEASURE',\n        'paperSize': 'PAPER_SIZE',\n        'paperWidth': 'POSITIVE_UNIVERSAL_MEASURE',\n        'scale': 'Integer',\n        'useFirstPageNumber': 'Boolean',\n        'usePrinterDefaults': 'Boolean',\n        'verticalDpi': 'Integer'\n    },\n    'headerFooter': {\n        'evenFooter': 'String',\n        'evenHeader': 'String',\n        'firstFooter': 'String',\n        'firstHeader': 'String',\n        'oddFooter': 'String',\n        'oddHeader': 'String',\n        'alignWithMargins': 'Boolean',\n        'differentFirst': 'Boolean',\n        'differentOddEven': 'Boolean',\n        'scaleWithDoc': 'Boolean'\n    },\n    'sheetView': {\n        'pane': {\n            'activePane': 'PANE',\n            'state': 'PANE_STATE',\n            'topLeftCell': null,\n            'xSplit': null,\n            'ySplit': null\n        },\n        'tabSelected': null,\n        'workbookViewId': null,\n        'rightToLeft': null,\n        'zoomScale': null,\n        'zoomScaleNormal': null,\n        'zoomScalePageLayoutView': null\n    },\n    'sheetFormat': {\n        'baseColWidth': null,\n        'customHeight': null,\n        'defaultColWidth': null,\n        'defaultRowHeight': null,\n        'outlineLevelCol': null,\n        'outlineLevelRow': null,\n        'thickBottom': null,\n        'thickTop': null,\n        'zeroHeight': null\n    },\n    'sheetProtection': {\n        'autoFilter': null,\n        'deleteColumns': null,\n        'deleteRow': null,\n        'formatCells': null,\n        'formatColumns': null,\n        'formatRows': null,\n        'hashValue': null,\n        'insertColumns': null,\n        'insertHyperlinks': null,\n        'insertRows': null,\n        'objects': null,\n        'password': null,\n        'pivotTables': null,\n        'scenarios': null,\n        'selectLockedCells': null,\n        'selectUnlockedCell': null,\n        'sheet': null,\n        'sort': null\n    },\n    'outline': {\n        'summaryBelow': null\n    },\n    'autoFilter': {\n        'startRow': null,\n        'endRow': null,\n        'startCol': null,\n        'endCol': null,\n        'filters': null\n    }\n};\n\nlet getObjItem = (obj, key) => {\n    let returnObj = obj;\n    let levels = key.split('.');\n\n    while (levels.length > 0) {\n        let thisLevelKey = levels.shift();\n        try {\n            returnObj = returnObj[thisLevelKey];\n        } catch (e) {\n            //returnObj = undefined;\n        }\n    }\n    return returnObj;\n};\n\nlet validator = function (key, val, type) {\n    switch (type) {\n\n    case 'PAPER_SIZE': \n        let sizes = Object.keys(types.paperSize);\n        if (sizes.indexOf(val) < 0) {\n            throw new TypeError('Invalid value for ' + key + '. Value must be one of ' + sizes.join(', '));\n        }\n        break;\n\n    case 'PAGE_ORDER':\n        types.pageOrder.validate(val);\n        break;\n\n    case 'ORIENTATION':\n        types.orientation.validate(val);\n        break;\n\n    case 'POSITIVE_UNIVERSAL_MEASURE': \n        types.positiveUniversalMeasure.validate(val);\n        break;\n\n    case 'CELL_COMMENTS':\n        types.cellComment.validate(val);\n        break;\n\n    case 'PRINT_ERROR': \n        types.printError.validate(val);\n        break;\n\n    case 'PANE':\n        types.pane.validate(val);\n        break;\n\n    case 'PANE_STATE':\n        types.paneState.validate(val);\n        break;\n\n    case 'Boolean':\n        if ([true, false, 1, 0].indexOf(val) < 0) {\n            throw new TypeError(key + ' expects value of true, false, 1 or 0');\n        }\n        break;\n\n    case 'Float': \n        if (parseFloat(val) !== val) {\n            throw new TypeError(key + ' expects value as a Float number');\n        }\n        break;\n\n    case 'Integer':\n        if (parseInt(val) !== val) {\n            throw new TypeError(key + ' expects value as an Integer');\n        }\n        break;\n\n    case 'String': \n        if (typeof val !== 'string') {\n            throw new TypeError(key + ' expects value as a String');\n        }\n        break;\n\n    default:\n        break;\n    }\n};\n\nlet traverse = function (o, keyParts, func) {\n    for (let i in o) {\n        let thisKeyParts = keyParts.concat(i);\n        let thisKey = thisKeyParts.join('.');\n        let thisType = getObjItem(optsTypes, thisKey);\n\n        if (typeof thisType === 'string') {\n            let thisItem = o[i];\n            func(thisKey, thisItem, thisType); \n        }\n        if (o[i] !== null && typeof o[i] === 'object') {\n            traverse(o[i], thisKeyParts, func);\n        }\n    }\n};\n\nmodule.exports = (opts) => {\n    traverse(opts, [], validator);\n};"]}