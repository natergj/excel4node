{"version":3,"sources":["../../../../source/lib/style/classes/fill.js"],"names":["utils","require","types","_","xmlbuilder","CTColor","Stop","opts","position","color","obj","undefined","toObject","Fill","indexOf","type","TypeError","bottom","degree","left","right","top","stops","Array","forEach","s","i","push","bgColor","fgColor","patternType","fillPattern","validate","stop","fXML","pFill","ele","att","module","exports"],"mappings":"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","file":"fill.js","sourcesContent":["const utils = require('../../utils.js');\nconst types = require('../../types/index.js');\nconst _ = require('lodash');\nconst xmlbuilder = require('xmlbuilder');\nconst CTColor = require('./ctColor.js');\n\nclass Stop { //ยง18.8.38\n    /** \n     * @class Stop\n     * @desc Stops for Gradient fills\n     * @param {Object} opts Options for Stop\n     * @param {String} opts.color Color of Stop\n     * @param {Number} opts.position Order of Stop with first stop being 0\n     * @returns {Stop}\n     */\n    constructor(opts, position) {\n        this.color = new CTColor(opts.color);\n        this.position = position;\n    }\n\n    /** \n     * @func Stop.toObject\n     * @desc Converts the Stop instance to a javascript object\n     * @returns {Object}\n     */\n    toObject() {\n        let obj = {};\n        this.color !== undefined ? obj.color = this.color.toObject() : null;\n        this.position !== undefined ? obj.position = this.position : null;\n        return obj;\n    }\n}\n\nclass Fill { //ยง18.8.20 fill (Fill)\n\n    /** \n     * @class Fill\n     * @desc Excel Fill \n     * @param {Object} opts\n     * @param {String} opts.type Type of Excel fill (gradient or pattern)\n     * @param {Number} opts.bottom If Gradient fill, the position of the bottom edge of the inner rectange as a percentage in decimal form. (must be between 0 and 1)\n     * @param {Number} opts.top If Gradient fill, the position of the top edge of the inner rectange as a percentage in decimal form. (must be between 0 and 1)\n     * @param {Number} opts.left If Gradient fill, the position of the left edge of the inner rectange as a percentage in decimal form. (must be between 0 and 1)\n     * @param {Number} opts.right If Gradient fill, the position of the right edge of the inner rectange as a percentage in decimal form. (must be between 0 and 1)\n     * @param {Number} opts.degree Angle of the Gradient\n     * @param {Array.Stop} opts.stops Array of position stops for gradient\n     * @returns {Fill}\n     */\n    constructor(opts) {\n\n        if (['gradient', 'pattern', 'none'].indexOf(opts.type) >= 0) {\n            this.type = opts.type;\n        } else {\n            throw new TypeError('Fill type must be one of gradient, pattern or none.');\n        }\n\n        switch (this.type) {\n        case 'gradient': //ยง18.8.24\n            if (opts.bottom !== undefined) {\n                if (opts.bottom < 0 || opts.bottom > 1) {\n                    throw new TypeError('Values for gradient fill bottom attribute must be a decimal between 0 and 1');\n                } else {\n                    this.bottom = opts.bottom;\n                }\n            }\n\n            if (opts.degree !== undefined) {\n                if (typeof opts.degree === 'number') {\n                    this.degree = opts.degree;\n                } else {\n                    throw new TypeError('Values of gradient fill degree must be of type number.');\n                }\n            }\n\n\n            if (opts.left !== undefined) {\n                if (opts.left < 0 || opts.left > 1) {\n                    throw new TypeError('Values for gradient fill left attribute must be a decimal between 0 and 1');\n                } else {\n                    this.left = opts.left;\n                }\n            }\n\n            if (opts.right !== undefined) {\n                if (opts.right < 0 || opts.right > 1) {\n                    throw new TypeError('Values for gradient fill right attribute must be a decimal between 0 and 1');\n                } else {\n                    this.right = opts.right;\n                }\n            }\n\n            if (opts.top !== undefined) {\n                if (opts.top < 0 || opts.top > 1) {\n                    throw new TypeError('Values for gradient fill top attribute must be a decimal between 0 and 1');\n                } else {\n                    this.top = opts.top;\n                }\n            }\n\n            if (opts.stops !== undefined) {\n                if (opts.stops instanceof Array) {\n                    opts.stops.forEach((s, i) => {\n                        this.stops.push(new Stop(s, i));\n                    });\n                } else {\n                    throw new TypeError('Stops for gradient fills must be sent as an Array');\n                }\n            }\n\n            break;\n\n        case 'pattern': //ยง18.8.32\n            if (opts.bgColor !== undefined) {\n                this.bgColor = new CTColor(opts.bgColor);\n            }\n\n            if (opts.fgColor !== undefined) {\n                this.fgColor = new CTColor(opts.fgColor);\n            }\n\n            if (opts.patternType !== undefined) {\n                types.fillPattern.validate(opts.patternType) === true ? this.patternType = opts.patternType : null; \n            }\n            break;\n\n        case 'none':\n            this.patternType = 'none';\n            break;\n        }\n    }\n\n    /** \n     * @func Fill.toObject\n     * @desc Converts the Fill instance to a javascript object\n     * @returns {Object}\n     */\n    toObject() {\n        let obj = {};\n\n        this.type !== undefined ? obj.type = this.type : null;\n        this.bottom !== undefined ? obj.bottom = this.bottom : null;\n        this.degree !== undefined ? obj.degree = this.degree : null;\n        this.left !== undefined ? obj.left = this.left : null;\n        this.right !== undefined ? obj.right = this.right : null;\n        this.top !== undefined ? obj.top = this.top : null;\n        this.bgColor !== undefined ? obj.bgColor = this.bgColor.toObject() : null;\n        this.fgColor !== undefined ? obj.fgColor = this.fgColor.toObject() : null;\n        this.patternType !== undefined ? obj.patternType = this.patternType : null;\n\n        if (this.stops !== undefined) {\n            obj.stop = [];\n            this.stops.forEach((s) => {\n                obj.stops.push(s.toObject());\n            });\n        }\n\n        return obj;\n    }\n\n    /**\n     * @alias Fill.addToXMLele\n     * @desc When generating Workbook output, attaches style to the styles xml file\n     * @func Fill.addToXMLele\n     * @param {xmlbuilder.Element} ele Element object of the xmlbuilder module\n     */\n    addToXMLele(fXML) {\n        let pFill = fXML.ele('patternFill').att('patternType', this.patternType);\n\n        if (this.fgColor instanceof CTColor) {\n            pFill.ele('fgColor').att(this.fgColor.type, this.fgColor[this.fgColor.type]);\n        }\n\n        if (this.bgColor instanceof CTColor) {\n            pFill.ele('bgColor').att(this.bgColor.type, this.bgColor[this.bgColor.type]);\n        }\n    }\n}\n\nmodule.exports = Fill;"]}